<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zambia Emergency Response - Emergency Reporting System</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/10.12.4/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.4/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.4/firebase-storage-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.4/firebase-auth-compat.js"></script>
    <link rel="stylesheet" href="css/styles.css">
</head>

<body class="min-h-screen text-gray-800">
    <!-- Connection Status Indicator -->
    <div id="connection-status" class="connection-status hidden">
        <span id="connection-indicator" class="online-indicator"></span>
        <span id="connection-text">Connected</span>
    </div>

    <!-- Alert Notification -->
    <div id="alert-notification" class="alert-notification">
        <div class="alert-header">
            <div class="alert-title">
                <i class="fas fa-bell alert-icon"></i>
                <span>NEW EMERGENCY ALERT</span>
            </div>
            <button class="alert-close" id="alert-close">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="alert-content">
            A new emergency has been reported and requires immediate attention.
        </div>
        <div class="alert-details">
            <div class="alert-detail-row">
                <span class="alert-detail-label">Type:</span>
                <span id="alert-type">Medical Emergency</span>
            </div>
            <div class="alert-detail-row">
                <span class="alert-detail-label">Location:</span>
                <span id="alert-location">Unknown Location</span>
            </div>
            <div class="alert-detail-row">
                <span class="alert-detail-label">Time:</span>
                <span id="alert-time">Just now</span>
            </div>
            <div class="alert-detail-row">
                <span class="alert-detail-label">Severity:</span>
                <span id="alert-severity">Critical</span>
            </div>
        </div>
        <div class="alert-actions">
            <button class="alert-btn alert-btn-primary" id="alert-view-details">
                View Details
            </button>
            <button class="alert-btn alert-btn-secondary" id="alert-dismiss">
                Dismiss
            </button>
        </div>
    </div>

    <!-- Sound Toggle Button -->
    <div class="alert-sound-toggle" id="sound-toggle">
        <i class="fas fa-volume-up"></i>
        <div class="alert-counter hidden" id="alert-counter">0</div>
    </div>

    <!-- Login Modal -->
    <div id="login-modal" class="modal">
        <div class="modal-content">
            <div class="p-6 border-b border-gray-200">
                <div class="flex justify-center mb-4">
                    <div class="bg-red-600 p-3 rounded-full">
                        <i class="fas fa-ambulance text-white text-3xl"></i>
                    </div>
                </div>
                <h2 class="text-2xl font-bold text-center">Welcome to Zambia Emergency Response</h2>
                <p class="text-gray-600 text-center mt-2">Please choose how you want to use the system</p>
            </div>

            <div class="p-6">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                    <div class="user-type-btn" data-type="reporter">
                        <div class="text-4xl mb-3 text-blue-600">
                            <i class="fas fa-user"></i>
                        </div>
                        <h3 class="font-bold text-lg mb-2">Report Emergency</h3>
                        <p class="text-gray-600 text-sm">I need to report an emergency incident</p>
                    </div>

                    <div class="user-type-btn" data-type="responder">
                        <div class="text-4xl mb-3 text-red-600">
                            <i class="fas fa-user-md"></i>
                        </div>
                        <h3 class="font-bold text-lg mb-2">Respond to Emergency</h3>
                        <p class="text-gray-600 text-sm">I'm a responder from a rescue center</p>
                    </div>

                    <div class="user-type-btn" data-type="guest">
                        <div class="text-4xl mb-3 text-green-600">
                            <i class="fas fa-user-clock"></i>
                        </div>
                        <h3 class="font-bold text-lg mb-2">Continue as Guest</h3>
                        <p class="text-gray-600 text-sm">Quick emergency reporting without account</p>
                    </div>
                </div>

                <div id="reporter-login" class="hidden">
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-1 required-field">Phone Number</label>
                        <input type="tel" id="reporter-phone"
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                            placeholder="+260 XXX XXX XXX">
                    </div>
                    <button id="reporter-login-btn"
                        class="w-full bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-lg font-semibold">
                        Continue as Reporter
                    </button>
                </div>

                <div id="responder-login" class="hidden">
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-1 required-field">Organization</label>
                        <select id="responder-org"
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            <option value="">Select your organization</option>
                            <option value="hospital">Hospital</option>
                            <option value="police">Police Station</option>
                            <option value="fire">Fire Station</option>
                            <option value="security">Security Company</option>
                        </select>
                    </div>

                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-1 required-field">Email Address</label>
                        <input type="email" id="responder-email"
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                            placeholder="your@email.com">
                    </div>

                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-1 required-field">Password</label>
                        <input type="password" id="responder-password"
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                            placeholder="Enter your password">
                    </div>

                    <button id="responder-login-btn"
                        class="w-full bg-red-600 hover:bg-red-700 text-white py-2 px-4 rounded-lg font-semibold">
                        Login as Responder
                    </button>
                </div>

                <div id="guest-login" class="hidden">
                    <div class="bg-blue-50 p-4 rounded-lg border border-blue-200 mb-4">
                        <div class="flex">
                            <div class="flex-shrink-0">
                                <i class="fas fa-info-circle text-blue-500 text-xl mt-1"></i>
                            </div>
                            <div class="ml-3">
                                <h3 class="text-sm font-medium text-blue-800">Guest Access</h3>
                                <div class="mt-2 text-sm text-blue-700">
                                    <p>As a guest, you can report emergencies and find nearby rescue centers. Some
                                        features may be limited.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <button id="guest-login-btn"
                        class="w-full bg-green-600 hover:bg-green-700 text-white py-2 px-4 rounded-lg font-semibold">
                        Continue as Guest
                    </button>
                </div>
            </div>

            <div class="p-4 bg-gray-100 text-center">
                <p class="text-sm text-gray-600">By continuing, you agree to our <a href="#" class="text-blue-600">Terms
                        of Service</a> and <a href="#" class="text-blue-600">Privacy Policy</a></p>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="bg-white shadow-lg">
        <div class="container mx-auto px-4 py-3 flex justify-between items-center header-container">
            <div class="flex items-center space-x-3">
                <div class="bg-red-600 p-2 rounded-lg">
                    <i class="fas fa-ambulance text-white text-2xl"></i>
                </div>
                <div>
                    <h1 class="text-xl font-bold">Zambia Emergency Response</h1>
                    <p class="text-xs text-gray-600">Citizen Emergency Reporting</p>
                </div>
            </div>
            <div class="flex items-center space-x-4 header-status">
                <div class="flex items-center space-x-2 bg-red-50 px-3 py-1 rounded-full">
                    <div class="w-3 h-3 bg-green-500 rounded-full pulse"></div>
                    <span class="text-sm font-medium" id="status">Ready to help</span>
                </div>
                <button id="user-menu"
                    class="text-sm bg-gray-100 hover:bg-gray-200 px-3 py-1 rounded-lg transition-colors">
                    <i class="fas fa-user-circle mr-1"></i> <span id="user-display">Guest</span>
                </button>
                <button id="logout-btn"
                    class="text-sm bg-red-100 hover:bg-red-200 text-red-800 px-3 py-1 rounded-lg transition-colors hidden">
                    <i class="fas fa-sign-out-alt mr-1"></i> Logout
                </button>
            </div>
        </div>
    </header>

    <!-- Main Content - Reporter/Guest View -->
    <main id="reporter-view" class="container mx-auto px-4 py-6 hidden">
        <div class="max-w-4xl mx-auto">
            <!-- Progress Indicator -->
            <div class="emergency-card p-5 mb-6">
                <div class="flex justify-between items-center mb-4">
                    <div class="flex items-center space-x-4">
                        <div class="step-indicator completed">
                            <i class="fas fa-check"></i>
                        </div>
                        <div class="step-indicator active">2</div>
                        <div class="step-indicator">3</div>
                        <div class="step-indicator">4</div>
                    </div>
                    <div class="text-sm font-medium text-gray-600">Step <span id="current-step">2</span> of 4</div>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill" style="width: 25%"></div>
                </div>
                <div class="flex justify-between mt-2 text-xs text-gray-600">
                    <div>Emergency Type</div>
                    <div>Details</div>
                    <div>Location</div>
                    <div>Confirmation</div>
                </div>
            </div>

            <!-- Form Navigation -->
            <div class="flex justify-between mb-6">
                <button id="prev-step"
                    class="px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-800 rounded-lg font-medium flex items-center hidden">
                    <i class="fas fa-arrow-left mr-2"></i> Back
                </button>
                <button id="next-step"
                    class="px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg font-medium flex items-center ml-auto">
                    Next <i class="fas fa-arrow-right ml-2"></i>
                </button>
            </div>

            <!-- Emergency Type Selection -->
            <div id="step-1" class="form-section active">
                <div class="emergency-card p-5 mb-6">
                    <h2 class="text-xl font-bold mb-2">What type of emergency are you reporting?</h2>
                    <p class="text-gray-600 mb-5">Select the category that best matches your emergency situation</p>

                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
                        <input type="radio" name="emergency-type" id="medical-emergency" value="medical"
                            class="emergency-type-radio">
                        <label for="medical-emergency" class="emergency-type-label">
                            <div class="emergency-type-icon text-red-600">🏥</div>
                            <div class="text-lg font-semibold">MEDICAL</div>
                            <div class="text-xs opacity-80">Injury or illness</div>
                        </label>

                        <input type="radio" name="emergency-type" id="fire-emergency" value="fire"
                            class="emergency-type-radio">
                        <label for="fire-emergency" class="emergency-type-label">
                            <div class="emergency-type-icon text-orange-600">🔥</div>
                            <div class="text-lg font-semibold">FIRE</div>
                            <div class="text-xs opacity-80">Fire or explosion</div>
                        </label>

                        <input type="radio" name="emergency-type" id="police-emergency" value="police"
                            class="emergency-type-radio">
                        <label for="police-emergency" class="emergency-type-label">
                            <div class="emergency-type-icon text-blue-600">👮</div>
                            <div class="text-lg font-semibold">POLICE</div>
                            <div class="text-xs opacity-80">Crime in progress</div>
                        </label>

                        <input type="radio" name="emergency-type" id="general-emergency" value="general"
                            class="emergency-type-radio">
                        <label for="general-emergency" class="emergency-type-label">
                            <div class="emergency-type-icon text-yellow-600">⚠️</div>
                            <div class="text-lg font-semibold">OTHER</div>
                            <div class="text-xs opacity-80">Other emergency</div>
                        </label>
                    </div>

                    <div class="bg-blue-50 p-4 rounded-lg border border-blue-200">
                        <div class="flex">
                            <div class="flex-shrink-0">
                                <i class="fas fa-info-circle text-blue-500 text-xl mt-1"></i>
                            </div>
                            <div class="ml-3">
                                <h3 class="text-sm font-medium text-blue-800">Need immediate help?</h3>
                                <div class="mt-2 text-sm text-blue-700">
                                    <p>If this is a life-threatening emergency, call <strong>991</strong> directly for
                                        fastest response.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Emergency Details Form -->
            <div id="step-2" class="form-section">
                <div class="emergency-card p-5 mb-6">
                    <h2 class="text-xl font-bold mb-2">Emergency Details</h2>
                    <p class="text-gray-600 mb-5">Please provide details about the emergency situation</p>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1 required-field">How many people
                                are affected?</label>
                            <select id="affected-people"
                                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                <option value="">Select number</option>
                                <option>1 person</option>
                                <option>2-5 people</option>
                                <option>6-10 people</option>
                                <option>More than 10 people</option>
                                <option>Not sure</option>
                            </select>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1 required-field">Emergency
                                severity</label>
                            <select id="emergency-severity"
                                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                <option value="">Select severity</option>
                                <option>Critical - Life threatening</option>
                                <option>Serious - Needs urgent attention</option>
                                <option>Moderate - Needs medical attention</option>
                                <option>Minor - First aid required</option>
                            </select>
                        </div>
                    </div>

                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-1 required-field">Emergency
                            description</label>
                        <textarea id="emergency-description"
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                            rows="3" placeholder="Please describe what happened..."></textarea>
                    </div>

                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-1">Upload photos (optional)</label>
                        <div class="flex items-center justify-center w-full">
                            <label
                                class="flex flex-col items-center justify-center w-full h-32 border-2 border-dashed border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50">
                                <div class="flex flex-col items-center justify-center pt-5 pb-6">
                                    <i class="fas fa-cloud-upload-alt text-gray-400 text-2xl mb-2"></i>
                                    <p class="text-xs text-gray-500">Click to upload or drag and drop</p>
                                </div>
                                <input id="image-upload" type="file" class="hidden" multiple accept="image/*">
                            </label>
                        </div>
                        <div id="image-preview-container" class="image-preview-container mt-3"></div>
                    </div>
                </div>
            </div>

            <!-- Location Information -->
            <div id="step-3" class="form-section">
                <div class="emergency-card p-5 mb-6">
                    <h2 class="text-xl font-bold mb-2">Emergency Location</h2>
                    <p class="text-gray-600 mb-5">Please verify your location or provide address details</p>

                    <div class="mb-4">
                        <div id="map" class="mb-4"></div>
                        <div class="flex justify-between items-center">
                            <div class="text-sm text-gray-600">
                                <i class="fas fa-location-dot text-red-600 mr-1"></i>
                                <span id="location-status">Detecting your location...</span>
                            </div>
                            <button id="refresh-location" class="text-sm text-blue-600 font-medium flex items-center">
                                <i class="fas fa-sync-alt mr-1"></i> Refresh Location
                            </button>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1 required-field">Address
                                line</label>
                            <input type="text" id="emergency-address"
                                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                placeholder="Street address">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Landmark (optional)</label>
                            <input type="text" id="emergency-landmark"
                                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                placeholder="Nearby landmark">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Contact Information -->
            <div id="step-4" class="form-section">
                <div class="emergency-card p-5 mb-6" id="contact-info-section">
                    <h2 class="text-xl font-bold mb-2">Your Contact Information</h2>
                    <p class="text-gray-600 mb-5">Please provide your contact details for follow-up</p>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Your name</label>
                            <input type="text" id="reporter-name"
                                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                placeholder="Full name">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Phone number</label>
                            <input type="tel" id="reporter-contact-phone"
                                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                placeholder="+260 XXX XXX XXX">
                        </div>
                    </div>

                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-1">Can responders contact you?</label>
                        <div class="flex space-x-4 mt-2">
                            <label class="inline-flex items-center">
                                <input type="radio" class="form-radio text-blue-600" name="contact" value="yes" checked>
                                <span class="ml-2">Yes, contact me</span>
                            </label>
                            <label class="inline-flex items-center">
                                <input type="radio" class="form-radio text-blue-600" name="contact" value="no">
                                <span class="ml-2">No, report anonymously</span>
                            </label>
                        </div>
                    </div>
                </div>

                <!-- Nearest Rescue Centers -->
                <div class="emergency-card p-5 mb-6">
                    <h2 class="text-xl font-bold mb-2">Nearest Rescue Centers</h2>
                    <p class="text-gray-600 mb-5">Based on your location and emergency type, we recommend contacting:
                    </p>

                    <div id="recommended-center" class="hidden mb-4 p-4 bg-green-50 border border-green-200 rounded-lg">
                        <div class="flex items-center mb-2">
                            <h3 class="font-bold text-lg">Recommended Center</h3>
                            <span class="recommended-badge">RECOMMENDED</span>
                        </div>
                        <div class="rescue-center-card recommended-center">
                            <div class="flex justify-between items-start">
                                <div>
                                    <h3 id="recommended-name" class="font-bold text-lg"></h3>
                                    <p id="recommended-distance" class="text-gray-600"></p>
                                    <div id="recommended-resources" class="flex items-center mt-2"></div>
                                </div>
                                <div class="text-right">
                                    <div id="recommended-phone" class="text-xl font-bold text-red-600"></div>
                                    <button
                                        class="mt-2 bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded-lg text-sm call-center">
                                        <i class="fas fa-phone mr-1"></i> Call Now
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="space-y-4" id="rescue-centers-list">
                        <!-- Rescue centers will be populated here -->
                    </div>

                    <button id="refresh-centers"
                        class="mt-4 w-full py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg text-sm font-medium transition-colors flex items-center justify-center">
                        <i class="fas fa-sync-alt mr-2"></i> Refresh Nearby Centers
                    </button>
                </div>

                <!-- Submit Button -->
                <div class="flex justify-between">
                    <button
                        class="px-6 py-3 bg-gray-200 hover:bg-gray-300 text-gray-800 rounded-lg font-medium flex items-center">
                        <i class="fas fa-arrow-left mr-2"></i> Back
                    </button>
                    <button id="submit-emergency"
                        class="px-6 py-3 bg-red-600 hover:bg-red-700 text-white rounded-lg font-medium flex items-center">
                        Report Emergency <i class="fas fa-arrow-right ml-2"></i>
                    </button>
                </div>
            </div>
        </div>
    </main>

    <!-- Main Content - Responder View -->
    <main id="responder-view" class="container mx-auto px-4 py-6 hidden">
        <div class="max-w-6xl mx-auto">
            <h2 class="text-2xl font-bold mb-6">Emergency Response Dashboard</h2>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                <div id="summary-active" data-filter="active" class="emergency-card p-5 text-center summary-card active">
                    <div class="text-3xl font-bold text-blue-600 mb-2" id="active-emergencies">0</div>
                    <div class="text-gray-600">Active Emergencies</div>
                </div>

                <div id="summary-responded" data-filter="responded" class="emergency-card p-5 text-center summary-card">
                    <div class="text-3xl font-bold text-green-600 mb-2" id="responded-emergencies">0</div>
                    <div class="text-gray-600">Responded To</div>
                </div>

                <div id="summary-resolved" data-filter="resolved" class="emergency-card p-5 text-center summary-card">
                    <div class="text-3xl font-bold text-gray-600 mb-2" id="resolved-emergencies">0</div>
                    <div class="text-gray-600">Resolved</div>
                </div>
            </div>

            <div class="emergency-card p-5 mb-6">
                <h3 class="text-lg font-bold mb-4">Active Emergencies</h3>

                <div class="space-y-4" id="emergencies-list">
                    <!-- Emergencies will be populated here -->
                    <div class="text-center py-8 text-gray-500">
                        <i class="fas fa-inbox text-4xl mb-3"></i>
                        <p>No active emergencies at this time</p>
                    </div>
                </div>
            </div>

            <div class="emergency-card p-5">
                <h3 class="text-lg font-bold mb-4">Response Tools</h3>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <button id="view-map-btn"
                        class="px-4 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium flex items-center justify-center">
                        <i class="fas fa-map-marker-alt mr-2"></i> View on Map
                    </button>

                    <button id="dispatch-unit-btn"
                        class="px-4 py-3 bg-green-600 hover:bg-green-700 text-white rounded-lg font-medium flex items-center justify-center">
                        <i class="fas fa-ambulance mr-2"></i> Dispatch Unit
                    </button>
                </div>
            </div>
        </div>
        <!-- Analytics Section -->
        <div class="emergency-card p-5 mt-6">
            <h3 class="text-lg font-bold mb-4">Emergency Analytics</h3>

            <!-- Time Period Selector -->
            <div class="flex justify-between items-center mb-6">
                <div class="flex space-x-2">
                    <button id="daily-report-btn" class="px-4 py-2 bg-blue-600 text-white rounded-lg font-medium">Daily
                        Report</button>
                    <button id="monthly-report-btn"
                        class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg font-medium">Monthly Report</button>
                </div>
                <div class="text-sm text-gray-600" id="report-period">Showing data for: Today</div>
            </div>

            <!-- Summary Stats -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                <div class="bg-blue-50 p-4 rounded-lg text-center">
                    <div class="text-2xl font-bold text-blue-600" id="total-emergencies">0</div>
                    <div class="text-sm text-gray-600">Total Emergencies</div>
                </div>
                <div class="bg-red-50 p-4 rounded-lg text-center">
                    <div class="text-2xl font-bold text-red-600" id="medical-emergencies">0</div>
                    <div class="text-sm text-gray-600">Medical Cases</div>
                </div>
                <div class="bg-orange-50 p-4 rounded-lg text-center">
                    <div class="text-2xl font-bold text-orange-600" id="fire-emergencies">0</div>
                    <div class="text-sm text-gray-600">Fire Incidents</div>
                </div>
                <div class="bg-blue-50 p-4 rounded-lg text-center">
                    <div class="text-2xl font-bold text-blue-600" id="police-emergencies">0</div>
                    <div class="text-sm text-gray-600">Police Cases</div>
                </div>
            </div>

            <!-- Map Visualization -->
            <div class="mb-4">
                <h4 class="font-medium mb-2">Emergency Hotspots</h4>
                <div id="analytics-map" style="height: 260px; border-radius: 8px;"></div>
            </div>

            <!-- Emergency Type Distribution -->
            <div class="mb-4">
                <h4 class="font-medium mb-2">Emergency Type Distribution</h4>
                <div class="bg-white p-3 rounded-lg shadow chart-container">
                    <canvas id="type-chart" height="80"></canvas>
                </div>
            </div>

            <!-- Time Pattern Chart -->
            <div class="mb-4">
                <h4 class="font-medium mb-2">Emergency Patterns</h4>
                <div class="bg-white p-3 rounded-lg shadow chart-container">
                    <canvas id="time-chart" height="80"></canvas>
                </div>
            </div>

            <!-- Detailed Report Table -->
            <div>
                <h4 class="font-medium mb-2">Detailed Report</h4>
                <div class="overflow-x-auto">
                    <table class="min-w-full bg-white rounded-lg overflow-hidden">
                        <thead class="bg-gray-100">
                            <tr>
                                <th class="py-2 px-4 text-left">Time</th>
                                <th class="py-2 px-4 text-left">Type</th>
                                <th class="py-2 px-4 text-left">Location</th>
                                <th class="py-2 px-4 text-left">Severity</th>
                            </tr>
                        </thead>
                        <tbody id="report-table-body" class="divide-y divide-gray-200">
                            <!-- Data will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </main>

    <!-- Emergency Action Footer -->
    <footer class="bg-white border-t border-gray-200 mt-8 py-4">
        <div class="container mx-auto px-4">
            <div class="flex flex-col md:flex-row justify-between items-center space-y-4 md:space-y-0">
                <div class="text-sm text-gray-600">
                    © 2025 Zambia Emergency Response System. All rights reserved. Developed by Edina Gabriella Ngalasa.
                </div>
                <div class="flex space-x-3">
                    <button class="text-sm bg-gray-100 hover:bg-gray-200 px-3 py-1 rounded-lg transition-colors">
                        <i class="fas fa-shield-alt mr-1"></i> Privacy
                    </button>
                    <button class="text-sm bg-gray-100 hover:bg-gray-200 px-3 py-1 rounded-lg transition-colors">
                        <i class="fas fa-file-alt mr-1"></i> Terms
                    </button>
                    <button class="text-sm bg-gray-100 hover:bg-gray-200 px-3 py-1 rounded-lg transition-colors">
                        <i class="fas fa-question-circle mr-1"></i> Help
                    </button>
                </div>
            </div>
        </div>
    </footer>

    <!-- Emergency Call Button -->
    <div class="floating-action">
        <i class="fas fa-phone-alt text-xl"></i>
    </div>

    <!-- Calling Modal -->
    <div id="calling-modal" class="calling-modal hidden">
        <div class="bg-white rounded-xl p-6 w-full max-w-md">
            <div class="text-center">
                <div class="text-5xl text-red-600 mb-4 phone-ring">
                    <i class="fas fa-phone"></i>
                </div>
                <h2 class="text-2xl font-bold mb-2">Calling Emergency Services</h2>
                <div id="calling-details" class="mb-4">
                    <p class="text-gray-600">Connecting to nearest dispatch center</p>
                </div>
                <div class="text-3xl font-mono font-bold text-red-600 mb-4">991</div>
                <div class="flex justify-center space-x-4">
                    <button id="confirm-call"
                        class="bg-red-600 hover:bg-red-700 text-white px-5 py-2 rounded-full font-semibold">
                        <i class="fas fa-phone mr-1"></i> Call
                    </button>
                    <button id="cancel-call"
                        class="bg-gray-300 hover:bg-gray-400 text-gray-800 px-5 py-2 rounded-full font-semibold">
                        Cancel
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Map Modal -->
    <div id="map-modal" class="map-modal hidden">
        <div class="map-modal-content">
            <div class="close-modal">
                <i class="fas fa-times"></i>
            </div>
            <h3 class="text-xl font-bold mb-4">Emergency Location Map</h3>
            <div id="emergency-map"></div>
            <div class="mt-4 flex justify-end space-x-2">
                <button id="dismiss-emergency-btn" class="px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-800 rounded-lg">Dismiss</button>
                <button id="resolve-emergency-btn" class="px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg">Resolve</button>
            </div>
        </div>
    </div>

    <!-- Dispatch Modal -->
    <div id="dispatch-modal" class="dispatch-modal hidden">
        <div class="dispatch-modal-content">
            <div class="close-modal">
                <i class="fas fa-times"></i>
            </div>
            <h3 class="text-xl font-bold mb-4">Dispatch Emergency Unit</h3>
            <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 mb-1 required-field">Select Unit</label>
                <select id="dispatch-unit"
                    class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    <option value="">Select a response unit</option>
                    <option value="unit-1">Ambulance Unit 1</option>
                    <option value="unit-2">Ambulance Unit 2</option>
                    <option value="unit-3">Police Patrol 1</option>
                    <option value="unit-4">Fire Truck 1</option>
                </select>
            </div>
            <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 mb-1">Additional Notes</label>
                <textarea id="dispatch-notes"
                    class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                    rows="3" placeholder="Add any special instructions..."></textarea>
            </div>
            <button id="confirm-dispatch"
                class="w-full bg-green-600 hover:bg-green-700 text-white py-2 px-4 rounded-lg font-semibold">
                Confirm Dispatch
            </button>
        </div>
    </div>

    <!-- Global Loading Overlay -->
    <div id="global-loading" class="global-loading hidden">
        <div class="global-loading-content">
            <div class="global-spinner"></div>
            <div id="global-loading-text" class="mt-3 text-white font-semibold">Loading...</div>
        </div>
    </div>

    <script src="js/firebase.js"></script>
    <script src="js/models/types.js"></script>
    <script src="js/db/collections.js"></script>
    <script src="js/repositories/emergenciesRepository.js"></script>
    <script src="js/repositories/rescueCentersRepository.js"></script>
    <script src="js/repositories/authRepository.js"></script>
    <script src="js/services/authService.js"></script>
    <script src="js/services/emergencyService.js"></script>
    <script src="js/controllers/dataSyncController.js"></script>
    <script src="js/app.js"></script>
</body>

</html>